<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>WiFi Vouchers</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <link
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
            rel="stylesheet"
        />
        <style>
            /* Print layout tuned for A4 portrait to fit 8 vouchers per page (2 columns × 4 rows).
               Uses explicit mm sizes and @page to make layout more reliable.
               Adjusted to increase card height, reduce QR size/padding, and allow visible overflow
               so credentials do not get clipped. */
            @page {
                size: A4 portrait;
                margin: 3mm;
            }

            @media print {
                /* Explicit page dimensions for A4 portrait */
                html,
                body {
                    width: 210mm;
                    height: 297mm;
                }

                .no-print {
                    display: none !important;
                }

                /* Force 2 columns on print for consistent 8-up layout */
                .voucher-grid {
                    display: grid !important;
                    grid-template-columns: repeat(2, 1fr) !important;
                    gap: 2mm !important;
                }

                /* Calculate card size to fit 4 rows within printable height.
                   Use the full usable page area (page height minus 2*margin) divided by 4.
                   We subtract a small gap to avoid clipping on printers with non-printable edges. */
                .voucher-card {
                    /* Make card a vertical flex container so the credential strip can sit at the bottom */
                    display: flex !important;
                    flex-direction: column !important;
                    justify-content: space-between !important;
                    break-inside: avoid;
                    page-break-inside: avoid;
                    margin: 0 !important;
                    padding: 2mm !important; /* slightly reduced padding to maximize usable area */
                    width: calc(
                        (210mm - 6mm) / 2 - 2mm
                    ) !important; /* (page width - margins)/2 - gap */
                    height: calc(
                        (297mm - 6mm) / 5 - 2mm
                    ) !important; /* (page height - margins)/5 - gap (5 rows) */
                    box-sizing: border-box;
                    /* Allow overflow to be visible in case credential box needs extra space */
                    overflow: visible !important;
                    position: relative;
                    min-height: 0 !important;
                }

                /* Ensure the main voucher body (the first child .flex) grows to fill available space
                   and can shrink without forcing the credential strip off the page.
                   Also prevent its content from overflowing the card area so the credential
                   strip remains visible in the allocated fixed height. */
                .voucher-card > .flex {
                    flex: 1 1 auto !important;
                    min-height: 0 !important;
                    display: flex !important;
                    overflow: hidden !important;
                    box-sizing: border-box !important;
                }

                /* Ensure QR wrapper fills its allocated area and remove inner padding.
                                   Use percentage width (~55% of the card) and an aspect-ratio so the QR grows larger
                                   while remaining square. Also include a larger max-width cap (in mm) to avoid overflow
                                   on very wide cards. Keeps flex centering so the QR stays aligned. */
                .voucher-card .flex-shrink-0 > div {
                    width: 55% !important;
                    max-width: 80mm !important;
                    aspect-ratio: 1 / 1 !important;
                    padding: 0.5mm !important;
                    display: flex !important;
                    align-items: center !important;
                    justify-content: center !important;
                    box-sizing: border-box !important;
                    /* Prevent the QR from growing so tall it overlaps the credential strip.
                                       Reserve space for the credential strip (14mm) and a small gap (2mm). */
                    max-height: calc(100% - 20mm - 2mm) !important;
                    overflow: hidden !important;
                }

                /* Make the QR image fill the wrapper cleanly */
                .voucher-card img {
                    width: 100% !important;
                    height: 100% !important;
                    object-fit: contain !important;
                    display: block !important;
                }

                /* Reduce typography and icon sizes in print so text fits within each card */
                .voucher-card h3 {
                    font-size: 11px !important;
                    margin: 0 !important;
                }
                .voucher-card p,
                .voucher-card .text-sm,
                .voucher-card .text-xs,
                .voucher-card .font-mono,
                .voucher-card span,
                .voucher-card div {
                    font-size: 8.5px !important;
                    line-height: 1.05 !important;
                }

                .voucher-card i,
                .voucher-card .fas {
                    font-size: 9px !important;
                }

                /* Tighten layout of access code box */
                .voucher-card .bg-gradient-to-r.from-blue-50 {
                    padding: 1.5mm 2mm !important;
                }
                .voucher-card .text-lg {
                    font-size: 10px !important;
                }
                /* Reduce padding on the small QR instruction box so it sits slightly higher on printed labels */
                .voucher-card .qr-instruction {
                    padding-top: 0.6mm !important;
                    padding-bottom: 0.6mm !important;
                    padding-left: 1.2mm !important;
                    padding-right: 1.2mm !important;
                    line-height: 1 !important;
                    font-size: 8.5px !important;
                }

                /* Ensure the credential strip (below voucher body) is visible and sized.
                   Reserve a smaller minimum height so main content above can be sized reliably,
                   but allow the credential area to grow to show full SSID/password text.
                   Layout uses two rows: headers on the first line, values on the second.
                   Password is right-aligned; SSID is left-aligned. */
                .voucher-card > .mt-2 {
                    display: flex !important;
                    flex-direction: column !important;
                    align-items: stretch !important;
                    justify-content: flex-end !important;
                    gap: 1mm !important;
                    /* smaller reserved min height, allow expansion to show full content */
                    min-height: 10mm !important;
                    max-height: none !important;
                    flex: 0 0 auto !important;
                    /* slightly reduced padding to fit within smaller reserved height */
                    padding: 1mm 1.2mm !important;
                    background: #f8fafc !important;
                    box-sizing: border-box !important;
                    font-size: 9.5px !important;
                    /* allow credentials to expand and remain visible */
                    overflow: visible !important;
                    /* Pin to bottom but permit overflow to be visible if content wraps */
                    position: absolute !important;
                    bottom: 2mm !important;
                    left: 0 !important;
                    right: 0 !important;
                    z-index: 10 !important;
                    margin: 0 !important;
                }
                /* Keep container as a row for the two columns (left=SSID, right=Password) */
                .voucher-card > .mt-2 .font-mono {
                    display: flex !important;
                    flex-direction: row !important;
                    align-items: flex-start !important;
                    justify-content: space-between !important;
                    gap: 4mm !important;
                    width: 100% !important;
                }
                /* Make each side a column: header label above value */
                .voucher-card > .mt-2 .font-mono > div {
                    display: flex !important;
                    flex-direction: column !important;
                    gap: 0.5mm !important;
                    width: 50% !important;
                    box-sizing: border-box !important;
                }
                /* Left side (SSID) left-aligned header and value */
                .voucher-card > .mt-2 .font-mono > div:first-child {
                    align-items: flex-start !important;
                    text-align: left !important;
                }
                /* Right side (Password) right-aligned header and value */
                .voucher-card > .mt-2 .font-mono > div:last-child {
                    align-items: flex-end !important;
                    text-align: right !important;
                }
                /* Header labels (small gray text) should appear on their own line */
                .voucher-card > .mt-2 .font-mono span.text-gray-500 {
                    display: block !important;
                    font-size: 9px !important;
                    color: #6b7280 !important;
                }
                /* Value styling: allow wrapping so full text is visible, no truncation */
                .voucher-card > .mt-2 .ssid-value,
                .voucher-card > .mt-2 .password-value {
                    white-space: normal !important;
                    word-break: break-word !important;
                    overflow-wrap: anywhere !important;
                    display: block !important;
                    font-size: 11px !important;
                    line-height: 1.05 !important;
                    font-weight: 600 !important;
                    max-width: 100% !important;
                }

                body {
                    margin: 0;
                    padding: 0;
                }

                .print-container {
                    max-width: none;
                    padding: 0;
                }
            }

            /* Keep normal screen behavior unchanged */
            @media screen and (min-width: 0) {
                .voucher-card {
                    page-break-inside: avoid;
                    break-inside: avoid;
                }
            }
        </style>
    </head>
    <body class="bg-gray-50">
        <!-- Header (no-print) -->
        <div class="no-print bg-white shadow-sm border-b">
            <div class="container mx-auto px-6 py-4">
                <div class="flex items-center justify-between">
                    <div>
                        <h1 class="text-2xl font-bold text-gray-800">
                            <i class="fas fa-ticket-alt mr-2 text-blue-600"></i
                            >WiFi Vouchers Generated
                        </h1>
                        <p class="text-gray-600 mt-1">
                            Total: {{VOUCHER_COUNT}} vouchers for network
                            "{{NETWORK_NAME}}" ({{NETWORK_SSID}})
                        </p>
                    </div>
                    <div class="flex space-x-3">
                        <a
                            href="/"
                            class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-medium transition-colors duration-200 inline-flex items-center"
                        >
                            <i class="fas fa-arrow-left mr-2"></i>Back to Upload
                        </a>
                        <a
                            href="/admin"
                            class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors duration-200 inline-flex items-center"
                        >
                            <i class="fas fa-cog mr-2"></i>Admin Panel
                        </a>
                        <button
                            onclick="window.print()"
                            class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-colors duration-200 inline-flex items-center"
                        >
                            <i class="fas fa-print mr-2"></i>Print Vouchers
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Vouchers Container -->
        <div class="container mx-auto px-6 py-6 print-container">
            <div
                class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 voucher-grid"
            >
                {{VOUCHER_CARDS}}
            </div>
        </div>

        <!-- Print Instructions (no-print) -->
        <div class="no-print bg-blue-50 border-t border-blue-200 mt-8">
            <div class="container mx-auto px-6 py-4">
                <div class="flex items-start space-x-3">
                    <i class="fas fa-info-circle text-blue-600 mt-1"></i>
                    <div>
                        <h3 class="font-semibold text-blue-900 mb-2">
                            Printing Tips
                        </h3>
                        <ul class="text-sm text-blue-800 space-y-1">
                            <li>• Use landscape orientation for better fit</li>
                            <li>
                                • Ensure "Print backgrounds" is enabled for
                                proper styling
                            </li>
                            <li>
                                • Adjust margins to "Minimum" for more vouchers
                                per page
                            </li>
                            <li>
                                • Consider using cardstock paper for durability
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>
