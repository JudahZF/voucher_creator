<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>WiFi Vouchers</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <link
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
            rel="stylesheet"
        />
        <style>
            /* Print layout tuned for A4 landscape to fit 6 vouchers per page (3 columns Ã— 2 rows).
               Uses explicit mm sizes and @page to make layout reliable. Increased label size and
               QR/code sizing to take advantage of the larger landscape space. */
            @page {
                size: A4 landscape;
                margin: 3mm;
            }

            @media print {
                /* Explicit page dimensions for A4 landscape */
                html,
                body {
                    width: 297mm;
                    height: 210mm;
                }

                .no-print {
                    display: none !important;
                }

                /* Use 3 columns on print for a 6-up layout */
                .voucher-grid {
                    display: grid !important;
                    grid-template-columns: repeat(3, 1fr) !important;
                    gap: 3mm !important;
                }

                /* Calculate card size to fit 2 rows within printable height.
                   Use the full usable page area (page height minus margins) divided by 2. */
                .voucher-card {
                    display: flex !important;
                    flex-direction: column !important;
                    /* Keep the main content pinned to the top of the card for print */
                    justify-content: flex-start !important;
                    break-inside: avoid;
                    page-break-inside: avoid;
                    margin: 0 !important;
                    padding: 2.5mm !important;
                    width: calc(
                        (297mm - 6mm) / 3 - 3mm
                    ) !important; /* (page width - margins)/3 - gap */
                    /* Let the card height be determined by its content for print */
                    height: auto !important;
                    box-sizing: border-box;
                    overflow: visible !important;
                    position: relative;
                    min-height: 0 !important;
                }

                /* Ensure the main voucher body fills available space */
                .voucher-card > .flex {
                    /* Allow the main row to wrap so full-width elements (like the
                       instruction) can sit directly beneath the main left/right columns.
                       Reduce the gap so the instruction sits closer to the main content. */
                    flex: 0 0 fit-content !important;
                    min-height: 0 !important;
                    display: flex !important;
                    flex-wrap: wrap !important;
                    align-items: flex-start !important;
                    gap: 0.5mm !important;
                    /* Make overflow visible so wrapped content isn't clipped */
                    overflow: visible !important;
                    box-sizing: border-box !important;
                }

                /* Treat the instruction as a full-width item inside the flex flow.
                   This makes it sit directly under the main row with only a small gap. */
                .voucher-card .qr-instruction-full {
                    width: 100% !important;
                    /* Remove the extra top margin and reduce vertical padding so this
                       instruction block sits immediately beneath the main row. */
                    margin-top: 0mm !important;
                    padding-top: 0.6mm !important;
                    padding-bottom: 0.6mm !important;
                    padding-left: 2mm !important;
                    padding-right: 2mm !important;
                    background: #f8fafc !important;
                    box-sizing: border-box !important;
                    position: relative !important;
                }

                /* QR wrapper: allow it to grow larger relative to the card but reserve space
                   for the credential strip at the bottom. */
                .voucher-card .flex-shrink-0 > div {
                    width: 45% !important; /* roughly half the card width */
                    max-width: 86mm !important;
                    aspect-ratio: 1 / 1 !important;
                    padding: 0.7mm !important;
                    display: flex !important;
                    align-items: center !important;
                    justify-content: center !important;
                    box-sizing: border-box !important;
                    /* Reserve space for credential strip (approx 18mm) and small gap.
                       Reduced reserved bottom space to allow ~6mm larger QR. */
                    max-height: calc(100% - 16mm) !important;
                    overflow: hidden !important;
                }

                /* Make the QR image fill the wrapper cleanly */
                .voucher-card img {
                    width: 100% !important;
                    height: 100% !important;
                    object-fit: contain !important;
                    display: block !important;
                }

                /* Increase typography for printed labels to take advantage of landscape */
                .voucher-card h3 {
                    margin: 0 !important;
                }
                .voucher-card p,
                .voucher-card .text-sm,
                .voucher-card .text-xs,
                .voucher-card .font-mono,
                .voucher-card span,
                .voucher-card div {
                    line-height: 1.05 !important;
                }

                .voucher-card i,
                .voucher-card .fas {
                    font-size: 22px !important;
                }

                /* Slightly larger padding on the access code box for readability */
                .voucher-card .bg-gradient-to-r.from-blue-50 {
                    padding: 2.2mm 2.6mm !important;
                }

                /* QR instruction box */
                .voucher-card .qr-instruction {
                    padding-top: 1mm !important;
                    padding-bottom: 1mm !important;
                    padding-left: 1.4mm !important;
                    padding-right: 1.4mm !important;
                    line-height: 1 !important;
                    font-size: 14px !important;
                }

                /* Credential strip: flow beneath the main content for print (not absolutely positioned) */
                .voucher-card > .mt-2 {
                    display: flex !important;
                    flex-direction: column !important;
                    align-items: stretch !important;
                    justify-content: flex-start !important;
                    gap: 1mm !important;
                    min-height: 0 !important;
                    max-height: none !important;
                    flex: 0 0 auto !important;
                    padding: 1.6mm 1.6mm !important;
                    background: #f8fafc !important;
                    box-sizing: border-box !important;
                    font-size: 14px !important;
                    overflow: visible !important;
                    /* Allow this credential strip to flow naturally beneath the voucher content */
                    margin: 2mm 0 0 0 !important;
                }

                body {
                    margin: 0;
                    padding: 0;
                }

                .print-container {
                    max-width: none;
                    padding: 0;
                }
            }

            /* Keep normal screen behavior unchanged */
            @media screen and (min-width: 0) {
                .voucher-card {
                    page-break-inside: avoid;
                    break-inside: avoid;
                }
            }
        </style>
    </head>
    <body class="bg-gray-50">
        <!-- Header (no-print) -->
        <div class="no-print bg-white shadow-sm border-b">
            <div class="container mx-auto px-6 py-4">
                <div class="flex items-center justify-between">
                    <div>
                        <h1 class="text-2xl font-bold text-gray-800">
                            <i class="fas fa-ticket-alt mr-2 text-blue-600"></i
                            >WiFi Vouchers Generated
                        </h1>
                        <p class="text-gray-600 mt-1">
                            Total: {{VOUCHER_COUNT}} vouchers for network
                            "{{NETWORK_NAME}}" ({{NETWORK_SSID}})
                        </p>
                    </div>
                    <div class="flex space-x-3">
                        <a
                            href="/"
                            class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-medium transition-colors duration-200 inline-flex items-center"
                        >
                            <i class="fas fa-arrow-left mr-2"></i>Back to Upload
                        </a>
                        <a
                            href="/admin"
                            class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors duration-200 inline-flex items-center"
                        >
                            <i class="fas fa-cog mr-2"></i>Admin Panel
                        </a>
                        <button
                            onclick="window.print()"
                            class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-colors duration-200 inline-flex items-center"
                        >
                            <i class="fas fa-print mr-2"></i>Print Vouchers
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Vouchers Container -->
        <div class="container mx-auto px-6 py-6 print-container">
            <div
                class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 voucher-grid"
            >
                {{VOUCHER_CARDS}}
            </div>
        </div>

        <!-- Print Instructions (no-print) -->
        <div class="no-print bg-blue-50 border-t border-blue-200 mt-8">
            <div class="container mx-auto px-6 py-4">
                <div class="flex items-start space-x-3">
                    <i class="fas fa-info-circle text-blue-600 mt-1"></i>
                    <div>
                        <h3 class="font-semibold text-blue-900 mb-2">
                            Printing Tips
                        </h3>
                        <ul class="text-sm text-blue-800 space-y-1">
                            <li>â€¢ Use landscape orientation for better fit</li>
                            <li>
                                â€¢ Ensure "Print backgrounds" is enabled for
                                proper styling
                            </li>
                            <li>
                                â€¢ Adjust margins to "Minimum" for more vouchers
                                per page
                            </li>
                            <li>
                                â€¢ Consider using cardstock paper for durability
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>
